# CMS内容分类标签模块 PRD

## 1. 模块概述

### 1.1 目标
设计一个灵活且可扩展的内容分类标签系统，用于对CMS中的内容进行精确分类和标记，支持复杂的多对多关系和树状结构。

### 1.2 核心概念
- **Category（分类）**: 内容的主要模块分类
- **Tag（标签）**: 具体的内容标签，可以在不同分类下形成不同的树状结构
- **TagAssociation（标签关联）**: 管理标签之间的父子关系，支持多对多关系

### 1.3 分类层级关系
```
Category（分类）
└── Tag（标签）
    └── TagAssociation（标签关联）
        └── Child Tag（子标签）
```

## 2. 数据表设计

### 2.1 分类表（Category）
| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| _id | ObjectId | 主键 | 自动生成的唯一标识 |
| key | String | 唯一索引 | 分类标识符 |
| name | String | 唯一索引 | 分类名称 |
| description | String | 可选 | 分类描述 |
| status | String | 默认值 | 状态：active/inactive |
| order | Number | 必填 | 排序值 |
| createdAt | Date | 自动生成 | 创建时间 |
| updatedAt | Date | 自动更新 | 更新时间 |

### 2.2 标签表（Tag）
| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| _id | ObjectId | 主键 | 自动生成的唯一标识 |
| key | String | 唯一索引 | 标签标识符 |
| name | String | 唯一索引 | 标签名称 |
| description | String | 可选 | 标签描述 |
| status | String | 默认值 | 状态：active/inactive |
| createdAt | Date | 自动生成 | 创建时间 |
| updatedAt | Date | 自动更新 | 更新时间 |

### 2.3 标签关联表（TagAssociation）
| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| _id | ObjectId | 主键 | 自动生成的唯一标识 |
| categoryId | ObjectId | 外键 | 关联分类ID |
| tagId | ObjectId | 外键 | 关联标签ID |
| parentAssociationId | ObjectId | 外键，可选 | 父关联ID |
| order | Number | 必填 | 排序值 |
| createdAt | Date | 自动生成 | 创建时间 |
| updatedAt | Date | 自动更新 | 更新时间 |

## 3. 索引设计

### 3.1 分类表索引
| 索引名 | 字段 | 类型 | 说明 |
|--------|------|------|------|
| idx_category_key | key | 唯一索引 | 分类标识符索引 |
| idx_category_name | name | 唯一索引 | 分类名称索引 |

### 3.2 标签表索引
| 索引名 | 字段 | 类型 | 说明 |
|--------|------|------|------|
| idx_tag_key | key | 唯一索引 | 标签标识符索引 |
| idx_tag_name | name | 唯一索引 | 标签名称索引 |

### 3.3 标签关联表索引
| 索引名 | 字段 | 类型 | 说明 |
|--------|------|------|------|
| idx_category_tag | (categoryId, tagId) | 唯一索引 | 分类标签关联索引 |
| idx_parent_association | parentAssociationId | 普通索引 | 父关联索引 |

## 4. 业务规则

### 4.1 分类规则
- 分类的 key 和 name 必须全局唯一
- 分类可以启用或禁用
- 分类可以排序
- 分类可以包含多个标签

### 4.2 标签规则
- 标签的 key 和 name 必须全局唯一
- 标签可以启用或禁用
- 标签可以在不同分类下形成不同的树状结构
- 标签可以没有父标签（作为根节点）

### 4.3 关联规则
- 同一分类下的标签不能重复
- 标签的父子关系通过关联表维护
- 关联表中的排序值决定标签的显示顺序
- 删除分类时，需要级联删除相关关联记录

## 5. 应用场景

### 5.1 产品分类
- 分类：产品
- 标签：手机、电脑、配件
- 结构：手机 > 电脑 > 配件

### 5.2 新闻分类
- 分类：新闻
- 标签：国内、国际、本地
- 结构：国内 > 国际 > 本地

### 5.3 服务分类
- 分类：服务
- 标签：技术支持、售后服务、培训
- 结构：技术支持 > 售后服务 > 培训

## 6. 注意事项

### 6.1 性能考虑
- 使用缓存存储分类标签树结构
- 实现标签数据的预加载
- 优化标签树查询性能
- 使用适当的索引优化查询

### 6.2 安全考虑
- 实现分类和标签操作的权限控制
- 防止标签代码和名称重复
- 防止循环引用
- 确保数据一致性

### 6.3 扩展性考虑
- 预留分类和标签属性扩展字段
- 支持标签的版本控制
- 支持标签的导入导出
- 支持标签的批量操作
